import { PrismaClient } from "@prisma/client";

const prisma = new PrismaClient();

const defaultTags = [
  { name: "quick", displayName: "Quick" },
  { name: "sweet", displayName: "Sweet" },
  { name: "savory", displayName: "Savory" },
  { name: "soup", displayName: "Soup" },
  { name: "bbq", displayName: "BBQ" },
  { name: "spicy", displayName: "Spicy" },
  { name: "dessert", displayName: "Dessert" },
  { name: "appetizer", displayName: "Appetizer" },
  { name: "vegan", displayName: "Vegan" },
];

const defaultRecipes = [
  {
    slug: "riz-saute",
    title: "Riz Saut√©",
    summary:
      "Riz saut√© √† base de restes de la veille, parfait pour utiliser les restes",
    emoji: "üçö",
    ingredients: [
      "3 carottes",
      "0.5 blanc de poireaux",
      "200g reste de poulet ou prot√©ine",
      "200g reste de riz de la veille",
      "2 oeufs",
      "c√©bette",
      "coriandre fra√Æche",
      "2 tbsp sauce maggi",
      "1 tbsp sauce hu√Ætre",
      "1 tbsp huile de s√©same",
      "4 tbsp huile v√©g√©tale",
      "1 tbsp vinaigre de riz",
      "2 tsp poivre blanc",
    ],
    instructions: [
      "Faire revenir les carottes dans un tout petit fond d'eau.",
      "Une fois l'eau √©vapor√©e, ajouter de l'huile v√©g√©tale et les poireaux et faire revenir.",
      "Ajouter la viande, bien m√©langer puis ajouter le vinaigre de riz, la sauce hu√Ætre et l'huile de s√©same et remuer.",
      "Ajouter le riz et bien m√©langer, faire revenir 3-4 minutes en remuant r√©guli√®rement.",
      "Faire un puits au centre, casser les oeufs et les brouiller rapidement au centre puis m√©langer avec le riz.",
      "Ajouter la sauce maggi et le poivre blanc, go√ªter et rectifier l'assaisonnement.",
      "Servir imm√©diatement avec la c√©bette et la coriandre fra√Æche hach√©es.",
    ],
    prepTime: 10,
    cookTime: 20,
    servings: 4,
    author: "Chef",
    tags: ["quick", "savory"],
    isDefault: true,
    isPublic: true,
  },
  {
    slug: "pate-carbonara",
    title: "P√¢tes Carbonara",
    summary: "Recette traditionnelle italienne de p√¢tes carbonara cr√©meuses",
    emoji: "üçù",
    ingredients: [
      "400g spaghetti",
      "200g guanciale ou lardons",
      "4 oeufs entiers",
      "100g parmesan r√¢p√©",
      "poivre noir fra√Æchement moulu",
      "sel",
    ],
    instructions: [
      "Faire bouillir une grande casserole d'eau sal√©e pour les p√¢tes.",
      "Couper le guanciale en petits cubes et le faire revenir dans une po√™le jusqu'√† ce qu'il soit croustillant.",
      "Dans un bol, battre les oeufs avec le parmesan et beaucoup de poivre noir.",
      "Cuire les spaghetti al dente selon les instructions du paquet.",
      "R√©server 1 tasse d'eau de cuisson des p√¢tes, puis √©goutter les p√¢tes.",
      "Ajouter les p√¢tes chaudes au guanciale dans la po√™le, hors du feu.",
      "Verser le m√©lange oeufs-parmesan en remuant vigoureusement, ajouter un peu d'eau de cuisson si n√©cessaire.",
      "Servir imm√©diatement avec du parmesan suppl√©mentaire et du poivre noir.",
    ],
    prepTime: 10,
    cookTime: 15,
    servings: 4,
    author: "Chef",
    tags: ["quick", "savory"],
    isDefault: true,
    isPublic: true,
  },
  {
    slug: "tiramisu",
    title: "Tiramisu",
    summary: "Dessert italien classique au caf√© et mascarpone",
    emoji: "üç∞",
    ingredients: [
      "6 jaunes d'oeufs",
      "150g sucre",
      "500g mascarpone",
      "3 blancs d'oeufs",
      "200g biscuits √† la cuill√®re",
      "300ml caf√© fort refroidi",
      "3 tbsp marsala ou amaretto",
      "cacao en poudre pour saupoudrer",
    ],
    instructions: [
      "Battre les jaunes d'oeufs avec le sucre jusqu'√† ce que le m√©lange blanchisse.",
      "Incorporer d√©licatement le mascarpone au m√©lange jaunes-sucre.",
      "Monter les blancs d'oeufs en neige ferme et les incorporer d√©licatement au m√©lange pr√©c√©dent.",
      "M√©langer le caf√© refroidi avec l'alcool.",
      "Tremper rapidement chaque biscuit dans le caf√© et les disposer dans un plat.",
      "√âtaler la moiti√© de la cr√®me sur les biscuits.",
      "R√©p√©ter avec une deuxi√®me couche de biscuits et terminer avec le reste de cr√®me.",
      "R√©frig√©rer au moins 4 heures ou toute la nuit.",
      "Saupoudrer de cacao avant de servir.",
    ],
    prepTime: 30,
    cookTime: 0,
    servings: 8,
    author: "Chef",
    tags: ["sweet", "dessert"],
    isDefault: true,
    isPublic: true,
  },
  {
    slug: "crepes-sucrees",
    title: "Cr√™pes sucr√©es",
    summary: "Cr√™pes fran√ßaises classiques fines et d√©licates, parfaites pour le dessert",
    emoji: "ü•û",
    ingredients: [
      "250g farine tout usage",
      "1 pinc√©e de sel",
      "1 tbsp sucre en poudre",
      "3 gros ≈ìufs",
      "600mL lait entier",
      "50g beurre non sal√©, fondu",
      "1 tsp extrait de vanille",
      "beurre suppl√©mentaire pour la cuisson",
    ],
    instructions: [
      "M√©langer la farine, le sel et le sucre dans un grand bol.",
      "Creuser un puits au centre et ajouter les ≈ìufs.",
      "Incorporer 240ml de lait en fouettant du centre vers l'ext√©rieur.",
      "Ajouter graduellement le reste du lait, fouetter jusqu'√† obtenir un m√©lange lisse.",
      "Couvrir et r√©frig√©rer pendant au moins 1 heure.",
      "Incorporer le beurre fondu et la vanille.",
      "Chauffer une po√™le √† cr√™pes de 25cm √† feu moyen.",
      "Beurrer l√©g√®rement la po√™le.",
      "Verser 60ml de p√¢te au centre et faire tourner imm√©diatement la po√™le.",
      "Cuire 40-60 secondes jusqu'√† ce que les bords soient dor√©s.",
      "Retourner d√©licatement, cuire 20-30 secondes de plus.",
      "Empiler les cr√™pes avec du papier parchemin entre les couches.",
    ],
    prepTime: 30,
    cookTime: 90,
    servings: 4,
    author: "Chef",
    tags: ["sweet", "dessert"],
    isDefault: true,
    isPublic: true,
  },
  {
    slug: "frango-assado",
    title: "Frango Assado (Portuguese Roasted Chicken)",
    summary: "Poulet r√¥ti portugais traditionnel marin√© √† l'ail, aux feuilles de laurier et au vin blanc",
    emoji: "üçó",
    ingredients: [
      "1.5kg poulet entier",
      "8 gousses d'ail, hach√©es",
      "4 feuilles de laurier",
      "120mL vin blanc",
      "3 tbsp huile d'olive",
      "2 tbsp paprika",
      "2 tsp sel",
      "1 tsp poivre noir",
      "2 citrons, press√©s",
      "1kg pommes de terre, coup√©es en quartiers",
      "2 oignons, tranch√©s",
    ],
    instructions: [
      "M√©langer l'ail, les feuilles de laurier, le vin, l'huile d'olive, le paprika, le sel, le poivre et le jus de citron.",
      "Mariner le poulet pendant au moins 2 heures ou toute la nuit.",
      "Pr√©chauffer le four √† 200¬∞C (400¬∞F).",
      "Placer le poulet dans un plat de cuisson avec les pommes de terre et les oignons.",
      "Verser la marinade sur le poulet et les l√©gumes.",
      "R√¥tir 60-75 minutes jusqu'√† ce que le poulet soit dor√© et bien cuit.",
      "Arroser toutes les 20 minutes avec le jus de cuisson.",
      "Laisser reposer 10 minutes avant de d√©couper et servir.",
    ],
    prepTime: 20,
    cookTime: 75,
    servings: 4,
    author: "Chef",
    tags: ["savory"],
    isDefault: true,
    isPublic: true,
  },
  {
    slug: "paella-valenciana",
    title: "Paella Valenciana",
    summary: "Plat de riz espagnol classique de Valence avec poulet, lapin, haricots et safran",
    emoji: "ü•ò",
    ingredients: [
      "400g riz bomba ou riz √† grain court",
      "0.5kg poulet, coup√© en morceaux",
      "300g lapin, coup√© en morceaux",
      "200g haricots verts, √©queut√©s",
      "200g haricots de lima",
      "2 poivrons rouges, tranch√©s",
      "4 tomates, r√¢p√©es",
      "100mL huile d'olive",
      "1.5L bouillon de poulet",
      "1 tsp filaments de safran",
      "4 gousses d'ail, hach√©es",
      "6 brins de romarin",
      "2 tsp sel",
      "quartiers de citron pour servir",
    ],
    instructions: [
      "Chauffer l'huile d'olive dans une po√™le √† paella de 15 pouces √† feu moyen-vif.",
      "Assaisonner le poulet et le lapin avec du sel, les faire dorer de tous c√¥t√©s. R√©server.",
      "Ajouter les haricots verts, les haricots de lima et les poivrons. Cuire 5 minutes.",
      "Ajouter l'ail et les tomates r√¢p√©es. Cuire jusqu'√† r√©duction des tomates.",
      "Remettre la viande dans la po√™le, ajouter le riz et remuer pour enrober de sofrito.",
      "Ajouter le bouillon chaud infus√© au safran et au romarin. Assaisonner de sel.",
      "Mijoter 18-20 minutes sans remuer. Faire tourner la po√™le occasionnellement.",
      "Laisser reposer 5 minutes couvert d'un torchon propre.",
      "Servir avec des quartiers de citron.",
    ],
    prepTime: 15,
    cookTime: 45,
    servings: 4,
    author: "Chef",
    tags: ["savory", "spicy"],
    isDefault: true,
    isPublic: true,
  },
  {
    slug: "pho-bo",
    title: "Pho Bo (Vietnamese Beef Soup)",
    summary: "Soupe de nouilles vietnamienne authentique avec bouillon aromatique, nouilles de riz et b≈ìuf",
    emoji: "üçú",
    ingredients: [
      "1kg os de b≈ìuf",
      "500g poitrine de b≈ìuf",
      "1 gros oignon, coup√© en deux",
      "1 morceau de gingembre (5cm)",
      "3 anis √©toil√©",
      "1 b√¢ton de cannelle",
      "6 clous de girofle",
      "2 tbsp sauce de poisson",
      "1 tbsp sel",
      "400g nouilles de riz (banh pho)",
      "200g aloyau de b≈ìuf cru, tranch√© finement",
      "germes de soja",
      "herbes fra√Æches (coriandre, basilic, menthe)",
      "quartiers de citron vert",
    ],
    instructions: [
      "Griller l'oignon et le gingembre √† flamme nue jusqu'√† noircissement. Rincer et r√©server.",
      "Griller l'anis √©toil√©, la cannelle et les clous de girofle dans une po√™le s√®che 2 minutes.",
      "Dans une grande casserole, ajouter les os de b≈ìuf, la poitrine, les l√©gumes grill√©s et les √©pices.",
      "Couvrir d'eau et porter √† √©bullition. √âcumer et mijoter 3-4 heures.",
      "Retirer la poitrine apr√®s 1 heure, trancher finement une fois refroidie.",
      "Filtrer le bouillon et assaisonner avec la sauce de poisson et le sel.",
      "Cuire les nouilles de riz selon les instructions de l'emballage.",
      "Servir les nouilles dans des bols, garnir de b≈ìuf cuit et cru, verser le bouillon chaud par-dessus.",
      "Servir avec les germes de soja, les herbes et les quartiers de citron vert √† part.",
    ],
    prepTime: 30,
    cookTime: 240,
    servings: 4,
    author: "Chef",
    tags: ["savory", "soup"],
    isDefault: true,
    isPublic: true,
  },
  {
    slug: "shakshuka-vegan",
    title: "Vegan Shakshuka",
    summary: "Version v√©g√©talienne du classique moyen-oriental avec tomates √©pic√©es et herbes fra√Æches",
    emoji: "üçÖ",
    ingredients: [
      "2 tbsp huile d'olive",
      "1 gros oignon, coup√© en d√©s",
      "1 poivron rouge, coup√© en d√©s",
      "4 gousses d'ail, hach√©es",
      "1 tsp cumin moulu",
      "1 tsp paprika",
      "0.5 tsp piment de Cayenne",
      "800g tomates broy√©es en conserve",
      "1 tsp sel",
      "0.5 tsp poivre noir",
      "0.25 cup persil frais, hach√©",
      "pain pita pour servir",
    ],
    instructions: [
      "Chauffer l'huile d'olive dans une grande po√™le √† feu moyen.",
      "Ajouter l'oignon et le poivron, cuire 5 minutes jusqu'√† ramollissement.",
      "Ajouter l'ail, le cumin, le paprika et le piment de Cayenne. Cuire 1 minute jusqu'√† parfum.",
      "Ajouter les tomates broy√©es, le sel et le poivre. Mijoter 15-20 minutes.",
      "Go√ªter et ajuster l'assaisonnement au besoin.",
      "Garnir de persil frais et servir avec du pain pita chaud.",
    ],
    prepTime: 10,
    cookTime: 25,
    servings: 4,
    author: "Chef",
    tags: ["quick", "savory", "vegan"],
    isDefault: true,
    isPublic: true,
  },
];

async function main() {
  console.log("üå± Seeding database...");

  // Create default tags
  console.log("Creating default tags...");
  for (const tag of defaultTags) {
    await prisma.tag.upsert({
      where: { name: tag.name },
      update: {},
      create: {
        name: tag.name,
        displayName: tag.displayName,
        isDefault: true,
      },
    });
  }

  // Create default recipes
  console.log("Creating default recipes...");
  for (const recipe of defaultRecipes) {
    // Create recipe
    const createdRecipe = await prisma.recipe.upsert({
      where: { slug: recipe.slug },
      update: {},
      create: {
        slug: recipe.slug,
        title: recipe.title,
        summary: recipe.summary,
        emoji: recipe.emoji,
        prepTime: recipe.prepTime,
        cookTime: recipe.cookTime,
        servings: recipe.servings,
        author: recipe.author,
        ingredients: recipe.ingredients,
        instructions: recipe.instructions,
        isDefault: recipe.isDefault,
        isPublic: recipe.isPublic,
      },
    });

    // Add tags to recipe
    for (const tagName of recipe.tags) {
      const tag = await prisma.tag.findUnique({
        where: { name: tagName },
      });

      if (tag) {
        await prisma.recipeTag.upsert({
          where: {
            recipeId_tagId: {
              recipeId: createdRecipe.id,
              tagId: tag.id,
            },
          },
          update: {},
          create: {
            recipeId: createdRecipe.id,
            tagId: tag.id,
          },
        });
      }
    }
  }

  console.log("‚úÖ Database seeded successfully!");
}

main()
  .catch((e) => {
    console.error("‚ùå Error seeding database:", e);
    process.exit(1);
  })
  .finally(async () => {
    await prisma.$disconnect();
  });
